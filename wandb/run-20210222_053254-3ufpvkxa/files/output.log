/usr/local/lib/python3.6/dist-packages/torch/optim/lr_scheduler.py:136: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  "https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate", UserWarning)
Epoch: [0] , Batch: [0][  0/337]	Time  0.748 ( 0.748)	Data  0.532 ( 0.532)	clip_loss   3.86 (  3.86)	img2img  -0.00 ( -0.00)	txt2txt   0.03 (  0.03)	img2txt   0.86 (  0.86)
Epoch: [0] , Batch: [50][ 50/337]	Time  0.643 ( 0.653)	Data  0.477 ( 0.486)	clip_loss   3.86 (  3.85)	img2img  -0.00 ( -0.00)	txt2txt   0.02 (  0.03)	img2txt   0.85 (  0.86)
Epoch: [0] , Batch: [100][100/337]	Time  0.644 ( 0.644)	Data  0.478 ( 0.478)	clip_loss   3.84 (  3.84)	img2img   0.00 ( -0.00)	txt2txt   0.04 (  0.03)	img2txt   0.87 (  0.87)
Epoch: [0] , Batch: [150][150/337]	Time  0.635 ( 0.639)	Data  0.469 ( 0.473)	clip_loss   3.82 (  3.84)	img2img  -0.00 ( -0.00)	txt2txt   0.03 (  0.03)	img2txt   0.88 (  0.87)
Epoch: [0] , Batch: [200][200/337]	Time  0.614 ( 0.636)	Data  0.448 ( 0.470)	clip_loss   3.81 (  3.83)	img2img  -0.00 ( -0.00)	txt2txt   0.02 (  0.03)	img2txt   0.89 (  0.87)
Traceback (most recent call last):
  File "trainer.py", line 118, in <module>
    corrnet_model,resnet_model=train_epoch(corrnet_model,trainLoader,resnet_model,cosine_sim,optimizer,epoch,print_freq,wandb,)
  File "/content/corrnet/trainers/__init__.py", line 49, in train_epoch
    for batch,(image,text_emb,instance_labels) in enumerate(trainLoader):
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 435, in __next__
    data = self._next_data()
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/dataloader.py", line 475, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py", line 44, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/usr/local/lib/python3.6/dist-packages/torch/utils/data/_utils/fetch.py", line 44, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/content/corrnet/dataloaders/loaders.py", line 23, in __getitem__
    img_emb = self.transforms(np.array(self.image_array[str(obj['_id'])]))
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "/usr/local/lib/python3.6/dist-packages/h5py/_hl/group.py", line 264, in __getitem__
    oid = h5o.open(self.id, self._e(name), lapl=self._lapl)
  File "h5py/_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py/_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py/h5o.pyx", line 190, in h5py.h5o.open
  File "h5py/h5i.pyx", line 40, in h5py.h5i.wrap_identifier
  File "<frozen importlib._bootstrap>", line 416, in parent
KeyboardInterrupt
